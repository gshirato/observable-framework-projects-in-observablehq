/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.2.
 * Original file: /npm/ml-levenberg-marquardt@2.1.1/src/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import e from"../is-any-array@0.1.1/_esm.js";import{Matrix as r,inverse as t}from"../ml-matrix@6.11.0/_esm.js";function n(e,r,t){let n=0;const a=t(r);for(let r=0;r<e.x.length;r++)n+=Math.abs(e.y[r]-a(e.x[r]));return n}function a(e,n,a,l,o){let m=a*l*l,i=r.eye(n.length,n.length,m);const s=o(n);let h=new Float64Array(e.x.length);for(let r=0;r<e.x.length;r++)h[r]=s(e.x[r]);let u=function(e,t,n,a,l){const o=n.length,m=e.x.length;let i=new Array(o);for(let r=0;r<o;r++){i[r]=new Array(m);let o=n.slice();o[r]+=a;let s=l(o);for(let n=0;n<m;n++)i[r][n]=t[n]-s(e.x[n])}return new r(i)}(e,h,n,l,o),f=function(e,t){const n=e.x.length;let a=new Array(n);for(let r=0;r<n;r++)a[r]=[e.y[r]-t[r]];return new r(a)}(e,h),w=t(i.add(u.mmul(u.transpose())));return(n=(n=new r([n])).sub(w.mmul(u).mmul(f).mul(l).transpose())).to1DArray()}function l(r,t,l={}){let{maxIterations:o=100,gradientDifference:m=.1,damping:i=0,errorTolerance:s=.01,minValues:h,maxValues:u,initialValues:f}=l;if(i<=0)throw new Error("The damping option must be a positive number");if(!r.x||!r.y)throw new Error("The data parameter must have x and y elements");if(!e(r.x)||r.x.length<2||!e(r.y)||r.y.length<2)throw new Error("The data parameter elements must be an array with more than 2 points");if(r.x.length!==r.y.length)throw new Error("The data parameter elements must have the same size");let w=f||new Array(t.length).fill(1),y=w.length;if(u=u||new Array(y).fill(Number.MAX_SAFE_INTEGER),h=h||new Array(y).fill(Number.MIN_SAFE_INTEGER),u.length!==h.length)throw new Error("minValues and maxValues must be the same size");if(!e(w))throw new Error("initialValues must be an array");let g,x=n(r,w,t),p=x<=s;for(g=0;g<o&&!p;g++){w=a(r,w,i,m,t);for(let e=0;e<y;e++)w[e]=Math.min(Math.max(h[e],w[e]),u[e]);if(x=n(r,w,t),isNaN(x))break;p=x<=s}return{parameterValues:w,parameterError:x,iterations:g}}export{l as default};
